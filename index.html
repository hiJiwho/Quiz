<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON í€´ì¦ˆ ìƒì„±ê¸° (í’€ê¸° ë° ì¸ì‡„)</title>
    <!-- Tailwind CSS ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ê¸°ë³¸ ê¸€ê¼´ ì„¤ì • */
        body {
            font-family: 'Inter', 'Pretendard', sans-serif;
        }

        /* * ======================================
         * ì¸ì‡„ ì „ìš© ìŠ¤íƒ€ì¼ (A4 ìš©ì§€)
         * ======================================
         */
        @media print {
            /* * 1. ì•±ì˜ UI(ë²„íŠ¼, ì…ë ¥ì°½ ë“±)ëŠ” ëª¨ë‘ ìˆ¨ê¹ë‹ˆë‹¤.
             */
            body > #app-container {
                display: none;
            }

            /* * 2. ì¸ì‡„ ì „ìš© ì˜ì—­(#printable-area)ë§Œ í™”ë©´ì— í‘œì‹œí•©ë‹ˆë‹¤.
             */
            body > #printable-area {
                display: block !important; /* ê°•ì œë¡œ ë³´ì´ê²Œ í•¨ */
            }

            /* * 3. A4 ìš©ì§€ ì—¬ë°± ì„¤ì •
             */
            @page {
                size: A4;
                margin: 2cm; /* ìƒí•˜ì¢Œìš° ì—¬ë°± 2cm */
            }

            /* * 4. ì¸ì‡„ìš© í°íŠ¸ ë° í˜ì´ì§€ ë‚˜ëˆ” ì„¤ì •
             */
            #printable-area {
                font-size: 11pt; /* ì¸ì‡„ì— ì í•©í•œ í°íŠ¸ í¬ê¸° */
                color: #000;
            }

            .print-question-item {
                margin-bottom: 20px;
                /* * ë¬¸ì œê°€ ë‹¤ìŒ í˜ì´ì§€ë¡œ ì˜ë¦¬ì§€ ì•Šë„ë¡ ì„¤ì •
                 * (í•œ ë¬¸ì œê°€ í˜ì´ì§€ ì¤‘ê°„ì— ì˜ë¦¬ëŠ” ê²ƒì„ ë°©ì§€)
                 */
                page-break-inside: avoid; 
            }

            .print-question-title {
                font-size: 1.2em;
                font-weight: bold;
                margin-bottom: 8px;
            }
            
            .print-options {
                list-style-type: decimal; /* 1. 2. 3. 4. 5. */
                list-style-position: inside;
                padding-left: 5px;
            }

            .print-answer {
                font-weight: bold;
                color: #333;
                margin-top: 8px;
            }
            
            /* (ì‹ ê·œ) ì¸ì‡„ìš© í’€ì´ ìŠ¤íƒ€ì¼ */
            .print-explanation {
                font-size: 0.95em;
                font-style: italic;
                color: #444;
                margin-top: 6px;
                border-left: 3px solid #ddd;
                padding-left: 10px;
            }
        }

        /* * ======================================
         * í™”ë©´ìš© ìŠ¤íƒ€ì¼ (Tailwind ì™¸ ì¶”ê°€)
         * ======================================
         */

        /* ì¸ì‡„ ì˜ì—­ì€ í‰ì†Œì—ëŠ” ìˆ¨ê²¨ë‘¡ë‹ˆë‹¤. */
        #printable-area {
            display: none;
        }

        /* JSì—ì„œ ì‚¬ìš©í•  'ìˆ¨ê¹€' í´ë˜ìŠ¤ */
        .hidden {
            display: none !important;
        }

        /* --- <button> ìŠ¤íƒ€ì¼ ì œê±° ---
        .option-btn.selected { ... }
        .option-btn.correct { ... }
        .option-btn.wrong { ... }
        */

        /* ìƒˆë¡œ ì¶”ê°€ëœ SVG ë³´ê¸° ìŠ¤íƒ€ì¼ */
        .svg-option {
            cursor: pointer;
            transition: opacity 0.2s ease;
        }

        /* SVG ë³´ê¸°ì— ë§ˆìš°ìŠ¤ í˜¸ë²„ ì‹œ */
        .svg-option:hover rect {
            fill: #e5e7eb; /* bg-gray-200 */
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <!-- 
      ======================================
      ì•± ë©”ì¸ ì»¨í…Œì´ë„ˆ
      ======================================
    -->
    <div id="app-container" class="bg-white p-6 md:p-10 rounded-2xl shadow-2xl w-full max-w-3xl">
        
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">JSON í€´ì¦ˆ ì•±</h1>
        <p class="text-center text-gray-500 mb-6">ë¬¸ì œë¥¼ JSONìœ¼ë¡œ ì…ë ¥í•˜ê³ , í€´ì¦ˆë¥¼ í’€ê±°ë‚˜ A4ë¡œ ì¸ì‡„í•˜ì„¸ìš”.</p>

        <!-- 
          ======================================
          1. JSON ì…ë ¥ ì„¹ì…˜
          ======================================
        -->
        <div id="json-input-section" class="mb-6">
            <label for="json-input" class="block text-sm font-medium text-gray-700 mb-2">
                ë¬¸ì œ JSON ë°ì´í„° (ì•„ë˜ í˜•ì‹ì„ ë§ì¶°ì£¼ì„¸ìš”)
            </label>
            <textarea id="json-input" rows="10" class="w-full p-3 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
            <p id="json-error" class="text-red-600 text-sm mt-1 hidden"></p>
            
            <div class="flex flex-col sm:flex-row gap-3 mt-4">
                <button id="load-json-btn" class="w-full sm:w-auto bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition shadow">
                    1. ì´ JSONìœ¼ë¡œ ë¬¸ì œ ë¶ˆëŸ¬ì˜¤ê¸°
                </button>
                <button id="reset-default-json-btn" class="w-full sm:w-auto bg-gray-200 text-gray-700 py-3 px-5 rounded-lg hover:bg-gray-300 transition">
                    ì˜ˆì œ JSONìœ¼ë¡œ ì´ˆê¸°í™”
                </button>
                <!-- (ì‹ ê·œ) JSON ë³µì‚¬ ë²„íŠ¼ -->
                <button id="copy-json-btn" class="w-full sm:w-auto bg-green-600 text-white py-3 px-5 rounded-lg font-semibold hover:bg-green-700 transition">
                    JSON ë³µì‚¬í•˜ê¸°
                </button>
            </div>
        </div>

        <!-- 
          (ì‹ ê·œ) 2. ì•¡ì…˜ ì»¨íŠ¸ë¡¤ ì„¹ì…˜ (JSON ë¡œë“œ í›„ ë³´ì„)
          - ì´ ì„¹ì…˜ì´ ëˆ„ë½ë˜ì–´ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
        -->
        <div id="action-controls" class="hidden mt-6 text-center">
            <p id="load-status" class="text-green-600 font-semibold mb-4">
                <span id="question-count">0</span>ê°œì˜ ë¬¸ì œë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button id="start-quiz-btn" class="w-full sm:w-auto bg-green-500 text-white py-3 px-8 rounded-lg font-bold hover:bg-green-600 transition shadow-lg">
                    <span class="text-xl">ğŸš€</span> í€´ì¦ˆ í’€ê¸° ì‹œì‘!
                </button>
                <button id="print-btn" class="w-full sm:w-auto bg-gray-700 text-white py-3 px-8 rounded-lg font-bold hover:bg-gray-800 transition shadow-lg">
                    <span class="text-xl">ğŸ–¨ï¸</span> ë¬¸ì œ/ì •ë‹µ A4ë¡œ ì¸ì‡„í•˜ê¸°
                </button>
            </div>
            <button id="back-to-json-btn" class="text-sm text-gray-500 hover:text-gray-700 mt-4">
                &larr; JSON ìˆ˜ì •í•˜ê¸°
            </button>
        </div>

        <!-- 
          ======================================
          (ì‹ ê·œ) 3. í€´ì¦ˆ í’€ê¸° ì„¹ì…˜ (ì´ˆê¸° ìˆ¨ê¹€)
          - ì´ ì„¹ì…˜ì´ ëˆ„ë½ë˜ì–´ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
          ======================================
        -->
        <div id="quiz-section" class="hidden mt-8">
            <!-- í€´ì¦ˆ í—¤ë” (ì§„í–‰ë„, ì¤‘ë‹¨ ë²„íŠ¼) -->
            <div class="flex justify-between items-center mb-4">
                <span id="progress-text" class="text-lg font-semibold text-gray-700">ë¬¸ì œ 1 / 10</span>
                <button id="quit-quiz-btn" class="text-sm text-red-600 hover:text-red-800 font-medium">
                    &times; í€´ì¦ˆ ì¤‘ë‹¨
                </button>
            </div>

            <!-- ë¬¸ì œ -->
            <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                <h2 id="question-title" class="text-2xl font-bold text-gray-900 mb-4">
                    ì—¬ê¸°ì— ì§ˆë¬¸ì´ í‘œì‹œë©ë‹ˆë‹¤.
                </h2>
                
                <!-- (ì‹ ê·œ) ë¬¸ì œ SVG ì»¨í…Œì´ë„ˆ -->
                <div id="question-svg-container" class="mb-4 flex justify-center hidden">
                    <!-- JSê°€ ì´ê³³ì— ë¬¸ì œ SVGë¥¼ ì‚½ì…í•©ë‹ˆë‹¤ -->
                </div>
            </div>
            
            <!-- ë³´ê¸° ëª©ë¡ (SVGë¡œ ë Œë”ë§ë¨) -->
            <ul id="options-list" class="space-y-3 mt-6">
                <!-- JSê°€ ì´ê³³ì— SVG ë³´ê¸° ë²„íŠ¼ì„ ìƒì„±í•©ë‹ˆë‹¤ -->
            </ul>
            
            <!-- í”¼ë“œë°± ë° ë‹¤ìŒ ë²„íŠ¼ -->
            <div class="mt-6 min-h-[80px]">
                <p id="feedback-text" class="text-xl font-bold text-center"></p>
                
                <!-- (ì‹ ê·œ) ë¬¸ì œ í’€ì´ í…ìŠ¤íŠ¸ -->
                <p id="explanation-text" class="mt-3 text-gray-700 bg-gray-50 p-4 rounded-lg border border-gray-200 hidden"></p>
                
                <button id="next-question-btn" class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition shadow mt-4 hidden">
                    ë‹¤ìŒ ë¬¸ì œ
                </button>
            </div>
        </div>


        <!-- 
          ======================================
        -->
        <div id="results-section" class="hidden mt-8 text-center">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">í€´ì¦ˆ ì™„ë£Œ!</h2>
            <p class="text-2xl text-gray-700 mb-8">
                ì´ <span id="total-questions-result"></span>ë¬¸ì œ ì¤‘
                <span id="final-score" class="font-bold text-blue-600"></span>ë¬¸ì œë¥¼ ë§í˜”ìŠµë‹ˆë‹¤!
            </p>
            <button id="restart-quiz-btn" class="w-full max-w-xs bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition shadow">
                ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°
            </button>
        </div>

    </div>

    <!-- 
      ======================================
      ì¸ì‡„ ì „ìš© HTML ì˜ì—­ (í‰ì†Œì—ëŠ” ì•ˆ ë³´ì„)
      ======================================
    -->
    <div id="printable-area">
        <h1 class="print-header" style="text-align: center; font-size: 1.5em; font-weight: bold; margin-bottom: 30px;">
            í€´ì¦ˆ ë¬¸ì œì§€ (ì •ë‹µ í¬í•¨)
        </h1>
        <!-- JSê°€ ì´ê³³ì— ì¸ì‡„ìš© ì»¨í…ì¸ ë¥¼ ìƒì„±í•©ë‹ˆë‹¤ -->
    </div>


    <!-- 
      ======================================
      ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¡œì§
      ======================================
    -->
    <script>
        // --- ì˜ˆì œ JSON ë°ì´í„° (ë¬¸ìì—´ í˜•íƒœ) ---
        const DEFAULT_QUIZ_JSON = `
[
    {
        "question": "ë‹¤ìŒ ì¤‘ HTML(HyperText Markup Language)ì˜ ì•½ìê°€ ì˜¬ë°”ë¥¸ ê²ƒì€?",
        "options": [
            { "text": "Hyperlinks and Text Markup Language" },
            { "text": "Home Tool Markup Language" },
            { "text": "HyperText Markup Language" },
            { "text": "Hyper Tool Multi Language" },
            { "text": "HighText Machine Language" }
        ],
        "answerIndex": 2,
        "explanation": "HTMLì€ 'HyperText Markup Language'ì˜ ì•½ìì…ë‹ˆë‹¤. ì›¹ í˜ì´ì§€ì˜ êµ¬ì¡°ë¥¼ ì •ì˜í•˜ëŠ” ë§ˆí¬ì—… ì–¸ì–´ì…ë‹ˆë‹¤."
    },
    {
        "question": "ì›¹ í˜ì´ì§€ì˜ ìŠ¤íƒ€ì¼(ìƒ‰ìƒ, ê¸€ê¼´, ë ˆì´ì•„ì›ƒ)ì„ ì§€ì •í•˜ëŠ” ì–¸ì–´ëŠ” ë¬´ì—‡ì¸ê°€ìš”?",
        "options": [
            { "text": "HTML" },
            { "text": "JQuery" },
            { "text": "Python" },
            { "text": "JavaScript" },
            { "text": "CSS" }
        ],
        "answerIndex": 4
    },
    {
        "question": "ë‹¤ìŒ ë³´ê¸° ì¤‘ 'ë‘¥ê·¼ ì‚¬ê°í˜•(Rounded Rectangle)'ì„ ë‚˜íƒ€ë‚´ëŠ” SVGëŠ” ë¬´ì—‡ì¸ê°€ìš”?",
        "options": [
            { "text": "ì›", "svgImage": "<svg viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'><circle cx='20' cy='20' r='18' stroke='black' stroke-width='2' fill='none'/></svg>" },
            { "text": "ì¼ë°˜ ì‚¬ê°í˜•", "svgImage": "<svg viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'><rect x='5' y='5' width='30' height='30' stroke='black' stroke-width='2' fill='none'/></svg>" },
            { "text": "ì‚¼ê°í˜•", "svgImage": "<svg viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'><polygon points='20,5 35,35 5,35' stroke='black' stroke-width='2' fill='none'/></svg>" },
            { "text": "ë‘¥ê·¼ ì‚¬ê°í˜•", "svgImage": "<svg viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'><rect x='5' y='5' width='30' height='30' rx='8' stroke='black' stroke-width='2' fill='none'/></svg>" },
            { "text": "íƒ€ì›", "svgImage": "<svg viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'><ellipse cx='20' cy='20' rx='18' ry='12' stroke='black' stroke-width='2' fill='none'/></svg>" }
        ],
        "answerIndex": 3,
        "explanation": "ì •ë‹µì€ 4ë²ˆì§¸ ë³´ê¸°ì…ë‹ˆë‹¤. <rect> íƒœê·¸ì˜ 'rx' ì†ì„±ì€ ëª¨ì„œë¦¬ì˜ ë‘¥ê·¼ ì •ë„ë¥¼ ì§€ì •í•©ë‹ˆë‹¤."
    }
]
`;

        // --- ì „ì—­ ë³€ìˆ˜ ë° ìƒíƒœ ---
        let quizData = []; // ë¶ˆëŸ¬ì˜¨ í€´ì¦ˆ ë°ì´í„°(ê°ì²´ ë°°ì—´)
        let currentQuestionIndex = 0;
        let score = 0;
        let isAnswered = false; // í˜„ì¬ ë¬¸ì œì— ë‹µí–ˆëŠ”ì§€ ì—¬ë¶€

        // --- DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸° ---
        const jsonInput = document.getElementById('json-input');
        const jsonError = document.getElementById('json-error');
        const loadJsonBtn = document.getElementById('load-json-btn');
        const resetDefaultJsonBtn = document.getElementById('reset-default-json-btn');
        const copyJsonBtn = document.getElementById('copy-json-btn'); // (ì‹ ê·œ) JSON ë³µì‚¬ ë²„íŠ¼
        
        const actionControls = document.getElementById('action-controls'); // (ìˆ˜ì •) main-controls -> action-controls
        const loadStatus = document.getElementById('load-status'); // (ìˆ˜ì •) ëˆ„ë½ë˜ì—ˆë˜ ID
        const questionCount = document.getElementById('question-count'); // (ìˆ˜ì •) ëˆ„ë½ë˜ì—ˆë˜ ID
        
        const startQuizBtn = document.getElementById('start-quiz-btn'); // (ìˆ˜ì •) ëˆ„ë½ë˜ì—ˆë˜ ID
        const printBtn = document.getElementById('print-btn'); // (ìˆ˜ì •) ëˆ„ë½ë˜ì—ˆë˜ ID
        const backToJsonBtn = document.getElementById('back-to-json-btn'); // (ì‹ ê·œ) JSON ìˆ˜ì • ë²„íŠ¼
        
        const quizSection = document.getElementById('quiz-section');
        const quitQuizBtn = document.getElementById('quit-quiz-btn');
        const progressText = document.getElementById('progress-text');
        const questionTitle = document.getElementById('question-title');
        const svgContainer = document.getElementById('question-svg-container'); // (ì‹ ê·œ) SVG ì»¨í…Œì´ë„ˆ
        const optionsList = document.getElementById('options-list');
        const feedbackText = document.getElementById('feedback-text');
        const explanationText = document.getElementById('explanation-text'); // (ì‹ ê·œ) í’€ì´ í…ìŠ¤íŠ¸ ìš”ì†Œ
        const nextQuestionBtn = document.getElementById('next-question-btn');

        const resultsSection = document.getElementById('results-section');
        const totalQuestionsResult = document.getElementById('total-questions-result');
        const finalScore = document.getElementById('final-score');
        const restartQuizBtn = document.getElementById('restart-quiz-btn');

        const printableArea = document.getElementById('printable-area');

        // --- í•¨ìˆ˜ ì •ì˜ ---

        /** 1. JSON ë¶ˆëŸ¬ì˜¤ê¸° ë° ìœ íš¨ì„± ê²€ì‚¬ */
        function loadJsonData() {
            try {
                const jsonData = JSON.parse(jsonInput.value);
                
                // ê°„ë‹¨í•œ ìœ íš¨ì„± ê²€ì‚¬
                if (!Array.isArray(jsonData) || jsonData.length === 0) {
                    throw new Error("ë°ì´í„°ëŠ” ë¹„ì–´ìˆì§€ ì•Šì€ ë°°ì—´(Array)ì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
                }
                
                // ê° ë¬¸ì œì˜ í˜•ì‹ ê²€ì‚¬
                for (const item of jsonData) {
                    if (!item.question || !Array.isArray(item.options) || item.options.length === 0 || typeof item.answerIndex !== 'number') {
                        throw new Error("JSON í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. 'question', 'options' ë°°ì—´, 'answerIndex' ìˆ«ìê°€ í•„ìš”í•©ë‹ˆë‹¤.");
                    }
                    
                    // (ìˆ˜ì •) options ë°°ì—´ì˜ ê° í•­ëª©ì´ {text: "..."} ê°ì²´ì¸ì§€ ê²€ì‚¬
                    for (const opt of item.options) {
                        if (typeof opt !== 'object' || opt === null || typeof opt.text !== 'string') {
                            throw new Error("ê° 'options' í•­ëª©ì€ 'text' ì†ì„±ì„ ê°€ì§„ ê°ì²´(object)ì—¬ì•¼ í•©ë‹ˆë‹¤.");
                        }
                        // (ì‹ ê·œ) ì˜µì…˜ì˜ svgImage ì†ì„±ì´ ìˆë‹¤ë©´, ë¬¸ìì—´ì´ì–´ì•¼ í•¨
                        if (opt.svgImage && typeof opt.svgImage !== 'string') {
                            throw new Error("optionsì˜ 'svgImage' ì†ì„±ì´ ì¡´ì¬í•œë‹¤ë©´, ë¬¸ìì—´(string)ì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
                        }
                    }

                    // (ì‹ ê·œ) svgImage ì†ì„±ì´ ìˆë‹¤ë©´, ë¬¸ìì—´ì´ì–´ì•¼ í•¨
                    if (item.svgImage && typeof item.svgImage !== 'string') {
                        throw new Error("'svgImage' ì†ì„±ì´ ì¡´ì¬í•œë‹¤ë©´, ë¬¸ìì—´(string)ì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
                    }
                    // (ì‹ ê·œ) explanation ì†ì„±ì´ ìˆë‹¤ë©´, ë¬¸ìì—´ì´ì–´ì•¼ í•¨
                    if (item.explanation && typeof item.explanation !== 'string') {
                        throw new Error("'explanation' ì†ì„±ì´ ì¡´ì¬í•œë‹¤ë©´, ë¬¸ìì—´(string)ì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
                    }
                }

                // ì„±ê³µ
                quizData = jsonData;
                jsonError.classList.add('hidden');
                
                // ì»¨íŠ¸ë¡¤ ë²„íŠ¼ í‘œì‹œ
                questionCount.textContent = quizData.length;
                loadStatus.classList.remove('hidden'); // (ì‹ ê·œ) ë¡œë“œ ìƒíƒœ í…ìŠ¤íŠ¸
                actionControls.classList.remove('hidden'); // (ìˆ˜ì •) action-controls í‘œì‹œ
                
                // ë‹¤ë¥¸ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
                quizSection.classList.add('hidden');
                resultsSection.classList.add('hidden');
                document.getElementById('json-input-section').classList.add('hidden');

            } catch (error) {
                // ì‹¤íŒ¨
                quizData = [];
                jsonError.textContent = `JSON ì˜¤ë¥˜: ${error.message}`;
                jsonError.classList.remove('hidden');
                actionControls.classList.add('hidden'); // (ìˆ˜ì •) action-controls ìˆ¨ê¸°ê¸°
            }
        }

        /** 2. í€´ì¦ˆ ì‹œì‘ */
        function startQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            
            actionControls.classList.add('hidden'); // (ìˆ˜ì •) action-controls ìˆ¨ê¸°ê¸°
            resultsSection.classList.add('hidden');
            quizSection.classList.remove('hidden');
            
            loadQuestion();
        }

        /** 3. ë¬¸ì œ ë¶ˆëŸ¬ì˜¤ê¸° (í€´ì¦ˆ í™”ë©´ ë Œë”ë§) */
        function loadQuestion() {
            // ì´ˆê¸°í™”
            isAnswered = false;
            feedbackText.textContent = '';
            explanationText.textContent = ''; // (ì‹ ê·œ) í’€ì´ í…ìŠ¤íŠ¸ ë¹„ìš°ê¸°
            explanationText.classList.add('hidden'); // (ì‹ ê·œ) í’€ì´ í…ìŠ¤íŠ¸ ìˆ¨ê¸°ê¸°
            nextQuestionBtn.classList.add('hidden');
            
            const currentQuestion = quizData[currentQuestionIndex];
            
            progressText.textContent = `ë¬¸ì œ ${currentQuestionIndex + 1} / ${quizData.length}`;
            questionTitle.textContent = currentQuestion.question;
            
            // (ì‹ ê·œ) SVG ë Œë”ë§ ë¡œì§
            if (currentQuestion.svgImage) {
                // svgImage ë¬¸ìì—´ì„ HTMLë¡œ ì‚½ì…
                svgContainer.innerHTML = currentQuestion.svgImage;
                // SVG ì»¨í…Œì´ë„ˆë¥¼ ë³´ì—¬ì¤Œ
                svgContainer.classList.remove('hidden');
            } else {
                // SVGê°€ ì—†ëŠ” ë¬¸ì œ
                svgContainer.innerHTML = ''; // ë¹„ìš°ê¸°
                svgContainer.classList.add('hidden'); // ìˆ¨ê¸°ê¸°
            }

            // ë³´ê¸° ë²„íŠ¼ ìƒì„± (SVGë¡œ ë³€ê²½)
            optionsList.innerHTML = ''; // ì´ì „ ë³´ê¸° ì‚­ì œ
            const svgNS = "http://www.w3.org/2000/svg"; // SVG ë„¤ì„ìŠ¤í˜ì´ìŠ¤

            currentQuestion.options.forEach((option, index) => {
                const li = document.createElement('li');
                
                // SVG ìš”ì†Œ ìƒì„±
                const svg = document.createElementNS(svgNS, 'svg');
                svg.setAttribute('width', '100%');
                svg.setAttribute('height', '56'); // ë²„íŠ¼ ë†’ì´ 56px
                svg.setAttribute('viewBox', '0 0 500 56'); // 500x56 ë·°ë°•ìŠ¤
                svg.classList.add('svg-option'); // CSS í´ë˜ìŠ¤ ì¶”ê°€

                // SVG ë°°ê²½ (ì‚¬ê°í˜•)
                const rect = document.createElementNS(svgNS, 'rect');
                rect.setAttribute('x', '1');
                rect.setAttribute('y', '1');
                rect.setAttribute('width', '498'); // ë·°ë°•ìŠ¤ ë„ˆë¹„ - (í…Œë‘ë¦¬*2)
                rect.setAttribute('height', '54'); // ë·°ë°•ìŠ¤ ë†’ì´ - (í…Œë‘ë¦¬*2)
                rect.setAttribute('rx', '8'); // ë‘¥ê·¼ ëª¨ì„œë¦¬
                rect.setAttribute('ry', '8');
                rect.setAttribute('fill', '#f3f4f6'); // bg-gray-100
                rect.setAttribute('stroke', '#d1d5db'); // border-gray-300
                rect.setAttribute('stroke-width', '1.5');
                
                // SVG í…ìŠ¤íŠ¸
                const text = document.createElementNS(svgNS, 'text');
                text.setAttribute('x', '20'); // ì™¼ìª½ ì—¬ë°± 20
                text.setAttribute('y', '28'); // ë†’ì´ì˜ ì ˆë°˜
                text.setAttribute('dominant-baseline', 'middle');
                text.setAttribute('fill', '#111827'); // text-gray-900
                text.setAttribute('font-size', '16');
                text.setAttribute('font-family', "'Inter', 'Pretendard', sans-serif");
                text.textContent = `(${index + 1}) ${option.text}`; // (ìˆ˜ì •) option.text ì‚¬ìš©
                
                // ë‚˜ì¤‘ì— ì‰½ê²Œ ì°¸ì¡°í•  ìˆ˜ ìˆë„ë¡ rectë¥¼ svg ê°ì²´ì— ì €ì¥
                svg.rect = rect; 

                // SVG ì¡°ë¦½
                svg.appendChild(rect);
                svg.appendChild(text);

                // (ì‹ ê·œ) ì„ ì§€(option)ì— svgImageê°€ ìˆë‹¤ë©´ ë Œë”ë§
                if (option.svgImage) {
                    const foreignObject = document.createElementNS(svgNS, 'foreignObject');
                    // SVG ë²„íŠ¼(viewBox 500)ì˜ ìš°ì¸¡ì— 40x40 ì˜ì—­ í• ë‹¹
                    foreignObject.setAttribute('x', '440'); // 500 - 50 (ì—¬ìœ ) - 10 (íŒ¨ë”©)
                    foreignObject.setAttribute('y', '8');  // (56 - 40) / 2
                    foreignObject.setAttribute('width', '40');
                    foreignObject.setAttribute('height', '40');
                    
                    // foreignObject ë‚´ë¶€ì— HTML(div)ì„ ë„£ì–´ SVG ë¬¸ìì—´ì„ ì‚½ì…
                    const div = document.createElement('div');
                    div.setAttribute('style', 'width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;');
                    div.innerHTML = option.svgImage; // SVG ë¬¸ìì—´ ì‚½ì…

                    // ì‚½ì…ëœ SVGê°€ ì»¨í…Œì´ë„ˆì— ë§ë„ë¡ í¬ê¸° ì¡°ì ˆ
                    const embeddedSvg = div.querySelector('svg');
                    if (embeddedSvg) {
                        embeddedSvg.setAttribute('width', '100%');
                        embeddedSvg.setAttribute('height', '100%');
                    }
                    
                    foreignObject.appendChild(div);
                    svg.appendChild(foreignObject);
                }
                
                // í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ SVGì— ì§ì ‘ ì—°ê²°
                svg.addEventListener('click', () => selectAnswer(svg, index));
                
                li.appendChild(svg);
                optionsList.appendChild(li);
            });
        }

        /** 4. ë‹µì•ˆ ì„ íƒ (SVG ë²„ì „) */
        function selectAnswer(selectedSvg, selectedIndex) {
            if (isAnswered) return; // ì´ë¯¸ ë‹µì„ ì„ íƒí–ˆë‹¤ë©´ ë¬´ì‹œ
            
            isAnswered = true;
            const currentQuestion = quizData[currentQuestionIndex];
            const correctIndex = currentQuestion.answerIndex;

            // ëª¨ë“  SVG ìš”ì†Œë¥¼ ê°€ì ¸ì˜´ (ìˆ˜ì •: .svg-option í´ë˜ìŠ¤ë§Œ ì„ íƒ)
            const allOptionSvgs = optionsList.querySelectorAll('.svg-option');
            
            // ì„ íƒí•œ SVGì˜ rect ìš”ì†Œë¥¼ ê°€ì ¸ì˜´ (ìˆ˜ì •: .rect ì†ì„±ì´ ì—†ìœ¼ë©´ querySelectorë¡œ ì°¾ìŒ)
            const selectedRect = selectedSvg.rect || selectedSvg.querySelector('rect');

            if (selectedIndex === correctIndex) {
                // ì •ë‹µ
                score++;
                // SVG ì†ì„± ë³€ê²½: ì´ˆë¡ìƒ‰
                selectedRect.setAttribute('fill', '#dcfce7'); // bg-green-100
                selectedRect.setAttribute('stroke', '#22c55e'); // border-green-500
                selectedRect.setAttribute('stroke-width', '2');
                
                feedbackText.textContent = 'ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤!';
                feedbackText.style.color = 'green';
            } else {
                // ì˜¤ë‹µ
                // SVG ì†ì„± ë³€ê²½: ë¶‰ì€ìƒ‰
                selectedRect.setAttribute('fill', '#fee2e2'); // bg-red-100
                selectedRect.setAttribute('stroke', '#ef4444'); // border-red-500
                selectedRect.setAttribute('stroke-width', '2');

                feedbackText.textContent = 'âŒ í‹€ë ¸ìŠµë‹ˆë‹¤.';
                feedbackText.style.color = 'red';

                // ì‹¤ì œ ì •ë‹µ SVGì— ì´ˆë¡ìƒ‰ í‘œì‹œ
                const correctSvg = allOptionSvgs[correctIndex];
                // (ìˆ˜ì •: .rect ì†ì„±ì´ ì—†ìœ¼ë©´ querySelectorë¡œ ì°¾ìŒ)
                const correctRect = correctSvg.rect || correctSvg.querySelector('rect');
                correctRect.setAttribute('fill', '#dcfce7');
                correctRect.setAttribute('stroke', '#22c55e');
                correctRect.setAttribute('stroke-width', '2');
            }

            // (ì‹ ê·œ) í’€ì´ í…ìŠ¤íŠ¸ í‘œì‹œ
            if (currentQuestion.explanation) {
                explanationText.textContent = currentQuestion.explanation;
                explanationText.classList.remove('hidden');
            }

            // ë‹¤ìŒ ë¬¸ì œ ë²„íŠ¼ í‘œì‹œ
            if (currentQuestionIndex < quizData.length - 1) {
                nextQuestionBtn.textContent = 'ë‹¤ìŒ ë¬¸ì œ';
            } else {
                nextQuestionBtn.textContent = 'ê²°ê³¼ ë³´ê¸°';
            }
            nextQuestionBtn.classList.remove('hidden');
        }

        /** 5. ë‹¤ìŒ ë¬¸ì œ ë˜ëŠ” ê²°ê³¼ ë³´ê¸° */
        function showNext() {
            currentQuestionIndex++;
            if (currentQuestionIndex < quizData.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        /** 6. ìµœì¢… ê²°ê³¼ í‘œì‹œ */
        function showResults() {
            quizSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');

            totalQuestionsResult.textContent = quizData.length;
            finalScore.textContent = score;
        }

        /** 7. ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸° (ì´ˆê¸°í™”) */
        function resetApp() {
            quizData = [];
            currentQuestionIndex = 0;
            score = 0;

            resultsSection.classList.add('hidden');
            quizSection.classList.add('hidden');
            actionControls.classList.add('hidden'); // (ìˆ˜ì •) action-controls ìˆ¨ê¸°ê¸°
            
            document.getElementById('json-input-section').classList.remove('hidden');
            jsonError.classList.add('hidden');
            loadDefaultJson(); // ì˜ˆì œ JSON ë‹¤ì‹œ ì±„ìš°ê¸°
        }
        
        /** 8. ì˜ˆì œ JSON ì±„ìš°ê¸° */
        function loadDefaultJson() {
            jsonInput.value = DEFAULT_QUIZ_JSON.trim();
        }

        /** 9. ì¸ì‡„ìš© HTML ìƒì„± ë° ì¸ì‡„ í˜¸ì¶œ */
        function prepareAndPrint() {
            printableArea.innerHTML = ''; // ì¸ì‡„ ì˜ì—­ ì´ˆê¸°í™”

            // ì œëª© ì¶”ê°€
            const title = document.createElement('h1');
            title.innerHTML = 'í€´ì¦ˆ ë¬¸ì œì§€ (ì •ë‹µ í¬í•¨)';
            title.style.textAlign = 'center';
            title.style.fontSize = '1.5em';
            title.style.fontWeight = 'bold';
            title.style.marginBottom = '30px';
            printableArea.appendChild(title);

            // ê° ë¬¸ì œ ë Œë”ë§
            quizData.forEach((question, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'print-question-item'; // CSSì—ì„œ page-break-inside: avoid; ì ìš©

                // ë¬¸ì œ
                const qTitle = document.createElement('h2');
                qTitle.className = 'print-question-title';
                qTitle.textContent = `${index + 1}. ${question.question}`;
                itemDiv.appendChild(qTitle);

                // ë³´ê¸°
                const optionsOl = document.createElement('ol');
                optionsOl.className = 'print-options';
                optionsOl.setAttribute('type', '1');
                question.options.forEach(option => {
                    const li = document.createElement('li');
                    li.textContent = option.text; // (ìˆ˜ì •) option.text ì‚¬ìš©
                    optionsOl.appendChild(li);
                });
                itemDiv.appendChild(optionsOl);

                // ì •ë‹µ
                const answer = document.createElement('p');
                answer.className = 'print-answer';
                const correctOptionText = question.options[question.answerIndex].text; // (ìˆ˜ì •) option.text ì‚¬ìš©
                answer.textContent = `ì •ë‹µ: (${question.answerIndex + 1}) ${correctOptionText}`;
                itemDiv.appendChild(answer);
                
                // (ì‹ ê·œ) í’€ì´ ì¶”ê°€
                if (question.explanation) {
                    const explanation = document.createElement('p');
                    explanation.className = 'print-explanation';
                    explanation.textContent = `í’€ì´: ${question.explanation}`;
                    itemDiv.appendChild(explanation);
                }

                printableArea.appendChild(itemDiv);
            });

            // ì‹œìŠ¤í…œ ì¸ì‡„ ëŒ€í™”ìƒì í˜¸ì¶œ
            window.print();
        }

        /** (ì‹ ê·œ) 10. JSON í…ìŠ¤íŠ¸ ë³µì‚¬ */
        function copyJsonToClipboard() {
            jsonInput.select(); // í…ìŠ¤íŠ¸ ì„ íƒ
            
            try {
                // 'copy' ëª…ë ¹ ì‹¤í–‰ (í´ë¦½ë³´ë“œ APIë³´ë‹¤ êµ¬í˜• ë¸Œë¼ìš°ì € ë° iframe í˜¸í™˜ì„±ì´ ì¢‹ìŒ)
                document.execCommand('copy');
                
                // ì‚¬ìš©ì í”¼ë“œë°±
                const originalText = copyJsonBtn.textContent;
                copyJsonBtn.textContent = 'ë³µì‚¬ ì™„ë£Œ!';
                copyJsonBtn.classList.replace('bg-green-600', 'bg-green-800'); // ìƒ‰ìƒ ë³€ê²½
                
                setTimeout(() => {
                    copyJsonBtn.textContent = originalText;
                    copyJsonBtn.classList.replace('bg-green-800', 'bg-green-600'); // ì›ìƒ ë³µêµ¬
                }, 2000);

            } catch (err) {
                console.error('JSON ë³µì‚¬ ì‹¤íŒ¨:', err);
                jsonError.textContent = 'í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                jsonError.classList.remove('hidden');
            }
        }


        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²° ---
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì˜ˆì œ JSON ì±„ìš°ê¸°
        document.addEventListener('DOMContentLoaded', loadDefaultJson);

        // 1. JSON ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼
        loadJsonBtn.addEventListener('click', loadJsonData);

        // 1-1. ì˜ˆì œ JSON ë³µì› ë²„íŠ¼
        resetDefaultJsonBtn.addEventListener('click', loadDefaultJson);
        
        // (ì‹ ê·œ) 1-2. JSON ë³µì‚¬ ë²„íŠ¼
        copyJsonBtn.addEventListener('click', copyJsonToClipboard);

        // 2-1. í€´ì¦ˆ ì‹œì‘ ë²„íŠ¼
        startQuizBtn.addEventListener('click', startQuiz);

        // 2-2. ì¸ì‡„ ë²„íŠ¼
        printBtn.addEventListener('click', prepareAndPrint);

        // (ì‹ ê·œ) 2-3. JSON ìˆ˜ì •ìœ¼ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼
        backToJsonBtn.addEventListener('click', () => {
            actionControls.classList.add('hidden');
            document.getElementById('json-input-section').classList.remove('hidden');
        });

        // 3-1. ë‹¤ìŒ ë¬¸ì œ ë²„íŠ¼
        nextQuestionBtn.addEventListener('click', showNext);
        
        // 3-2. í€´ì¦ˆ ì¤‘ë‹¨ ë²„íŠ¼
        quitQuizBtn.addEventListener('click', resetApp);
        
        // 4-1. ë‹¤ì‹œ í’€ê¸° ë²„íŠ¼ (ê²°ê³¼ í™”ë©´)
        restartQuizBtn.addEventListener('click', resetApp);

    </script>
</body>
</html>
